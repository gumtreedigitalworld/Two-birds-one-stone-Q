<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gallery | Two Birds One Stone Q</title>
    <meta name="description" content="Take a glimpse of our beautiful cafe and delicious dishes at Two Birds One Stone Q in Mermaid Waters, QLD.">

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Gallery | Two Birds One Stone Q">
    <meta property="og:description" content="Take a glimpse of our beautiful cafe and delicious dishes at Two Birds One Stone Q in Mermaid Waters, QLD.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://twobirdsonestonq.com/gallery">
    <meta property="og:image" content="https://lh3.googleusercontent.com/p/AF1QipP3k2O7kxZQqYJ9sZXxZxZxZxZ">

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Gallery | Two Birds One Stone Q">
    <meta name="twitter:description" content="Take a glimpse of our beautiful cafe and delicious dishes at Two Birds One Stone Q in Mermaid Waters, QLD.">
    <meta name="twitter:image" content="https://lh3.googleusercontent.com/p/AF1QipP3k2O7kxZQqYJ9sZXxZxZxZxZ">

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#FFFFFF',
                        secondary: '#F9FAFB',
                        dark: '#1F2937',
                        accent: '#D2B48C',
                        'accent-dark': '#856868',
                    },
                    fontFamily: {
                        serif: ['Cormorant Garamond', 'serif'],
                        sans: ['Montserrat', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="https://raw.githubusercontent.com/gumtreedigitalworld/Two-birds-one-stone-Q/refs/heads/main/favicon.ico">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500;600;700&family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- ****************************************************** -->
    <!-- ** STEP 1: INCLUDE MASONRY & IMAGESLOADED LIBRARIES ** -->
    <!-- ****************************************************** -->
    <script src="https://unpkg.com/imagesloaded@5/imagesloaded.pkgd.min.js"></script>
    <script src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>


    <style>
        body { font-family: 'Montserrat', sans-serif; overflow-x: hidden; }
        h1, h2, h3, h4, h5, h6 { font-family: 'Cormorant Garamond', serif; }
        html { scroll-behavior: smooth; }
        ::-webkit-scrollbar { width: 10px; }
        ::-webkit-scrollbar-track { background: #F9FAFB; }
        ::-webkit-scrollbar-thumb { background: #D2B48C; border-radius: 5px; }
        ::-webkit-scrollbar-thumb:hover { background: #856868; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in { animation: fadeIn 0.6s ease-out forwards; }
        
        @keyframes pulse { 50% { opacity: .5; } }
        .skeleton {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
            background-color: #e2e8f0;
            border-radius: 0.5rem;
            min-height: 250px;
            width: 100%;
        }

        /* ************************************************** */
        /* ** STEP 2: CSS CHANGES FOR MASONRY.JS           ** */
        /* ************************************************** */
        
        /* The grid container is now a positioning context. No more column-count! */
        .masonry-grid {
            position: relative;
        }

        /* The grid items now have a width. Masonry will calculate top/left. */
        .masonry-item {
            margin-bottom: 1rem;
            width: 100%; /* Default for single column on mobile */
        }
        /* Responsive widths for different screen sizes */
        @media (min-width: 640px) {
            .masonry-item {
                 /* 3 columns: 33.333% width minus gutter */
                width: calc(33.333% - 1rem);
            }
        }
        @media (min-width: 1024px) {
            .masonry-item {
                 /* 4 columns: 25% width minus gutter */
                width: calc(25% - 1rem);
            }
        }


        .nav-link { position: relative; }
        .nav-link::after { content: ''; position: absolute; bottom: -4px; left: 0; width: 0; height: 2px; background: #D2B48C; transition: width 0.3s ease; }
        .nav-link:hover::after, .nav-link.active::after { width: 100%; }

        .gallery-item { transition: transform 0.3s ease, box-shadow 0.3s ease; cursor: pointer; }
        .gallery-item:hover { transform: scale(1.05); box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2); }

        .lightbox {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.95); z-index: 9999; opacity: 0;
            transition: opacity 0.3s ease;
        }
        .lightbox.active { display: flex; opacity: 1; }
        .lightbox img { max-width: 65%; max-height: 90vh; object-fit: contain; }
    </style>
</head>
<body class="bg-secondary text-dark">

    <!-- Header -->
    <header id="header" class="bg-white/80 backdrop-blur-sm shadow-md fixed w-full top-0 z-50">
        <nav class="container mx-auto px-4 md:px-20 py-4 flex justify-between items-center">
            <a href="./" class="text-2xl md:text-3xl font-serif font-bold text-dark hover:text-accent transition-colors">
                Two Birds One Stone Q
            </a>
            <div class="hidden md:flex space-x-8">
                <a href="./" class="nav-link text-dark hover:text-accent transition-colors font-medium">Home</a>
                <a href="menu.html" class="nav-link text-dark hover:text-accent transition-colors font-medium">Menu</a>
                <a href="gallery.html" class="nav-link text-dark hover:text-accent transition-colors font-medium active">Gallery</a>
                <a href="./#contact" onclick="scrollToContact(event)" class="nav-link text-dark hover:text-accent transition-colors font-medium">Contact</a>
            </div>
            <button id="mobile-menu-btn" class="md:hidden text-dark focus:outline-none">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 M4 6h16M4 12h16M4 18h16"></path></svg>
            </button>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="pt-24">
        <section class="py-20 bg-secondary min-h-screen">
            <div class="container mx-auto px-4">
                <div class="text-center mb-12 fade-in">
                    <h1 class="text-4xl md:text-6xl font-serif font-bold mb-4 text-dark">A Glimpse of Our Cafe</h1>
                    <div class="w-24 h-1 bg-accent mx-auto mb-6"></div>
                    <p class="text-lg text-gray-600">Experience the ambiance and artistry of our culinary creations</p>
                </div>

                <div id="gallery-grid" class="masonry-grid max-w-7xl mx-auto">
                    <!-- Skeletons will be replaced by Masonry items -->
                </div>

                <div class="text-center mt-12 fade-in">
                    <button id="load-more-btn" class="bg-accent hover:bg-accent-dark text-white font-semibold px-8 py-3 rounded-full transition-all duration-300 transform hover:scale-105 hidden">
                        Load More Images
                    </button>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-dark text-white pt-16 pb-8">
        <div class="container mx-auto px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-8">
                <!-- About Us -->
                <div>
                    <h3 class="text-lg font-serif font-bold mb-4 text-accent">About Us</h3>
                    <p class="text-gray-400">Your local cafe by the water, serving quality food with a side of warmth and genuine connection.</p>
                </div>
                <!-- Quick Links -->
                <div>
                    <h3 class="text-lg font-serif font-bold mb-4 text-accent">Quick Links</h3>
                    <ul class="space-y-2">
                        <li><a href="/" class="hover:text-accent transition-colors">Home</a></li>
                        <li><a href="menu.html" class="hover:text-accent transition-colors">Menu</a></li>
                        <li><a href="gallery.html" class="hover:text-accent transition-colors">Gallery</a></li>
                        <li><a href="/#contact" class="hover:text-accent transition-colors">Contact</a></li>
                    </ul>
                </div>
                <!-- Contact Us -->
                <div>
                    <h3 class="text-lg font-serif font-bold mb-4 text-accent">Contact Us</h3>
                    <p class="text-gray-400">Shop B10/14 Allandale Entrance<br>Mermaid Waters QLD 4218</p>
                    <a href="https://maps.google.com/maps?q=Two%20Birds%20One%20Stone%20Q%20Shop%20B10/14%20Allandale%20Entrance%20Mermaid%20Waters%20QLD%204218%20Australia" target="_blank" rel="noopener noreferrer" class="text-accent hover:text-accent-dark transition-colors mt-2 inline-block">Get Directions</a>
                </div>
                <!-- Follow Us -->
                <div>
                    <h3 class="text-lg font-serif font-bold mb-4 text-accent">Follow Us</h3>
                    <a href="https://www.instagram.com/twobirdsonestonq" target="_blank" rel="noopener noreferrer" class="flex items-center hover:text-accent transition-colors" aria-label="Visit our Instagram">
                        <svg class="w-6 h-6 mr-2" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                        </svg>
                        @twobirdsonestonq
                    </a>
                </div>
            </div>
            <div class="border-t border-gray-700 pt-8 mt-8 text-center text-gray-500">
                <p>&copy; 2025 Two Birds One Stone Q. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Lightbox -->
    <div id="lightbox" class="lightbox items-center justify-center">
        <button id="lightbox-close" class="absolute top-4 right-4 text-white text-4xl font-bold hover:text-accent transition-colors z-10" aria-label="Close lightbox">&times;</button>
        <button id="lightbox-prev" class="absolute left-4 text-white text-6xl font-bold hover:text-accent transition-colors z-10" aria-label="Previous image">&#8249;</button>
        <button id="lightbox-next" class="absolute right-4 text-white text-6xl font-bold hover:text-accent transition-colors z-10" aria-label="Next image">&#8250;</button>
        <img id="lightbox-img" src="" alt="Gallery image" class="rounded-lg">
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const galleryGrid = document.getElementById('gallery-grid');
        const loadMoreBtn = document.getElementById('load-more-btn');
        // ... (lightbox constants remain the same)

        let allImages = [];
        let displayedImages = 0;
        let currentLightboxIndex = 0;
        const imagesPerLoad = 8;
        const GALLERY_URL = 'https://raw.githubusercontent.com/gumtreedigitalworld/Two-birds-one-stone-Q/main/gallery.json';

        // ******************************************************** */
        // ** STEP 3: JAVASCRIPT CHANGES FOR MASONRY.JS          ** */
        // ******************************************************** */

        // This variable will hold our Masonry instance
        let msnry;

        const showSkeletons = () => {
            // Skeleton loader now also uses masonry-item class for sizing
            let skeletons = '';
            for (let i = 0; i < imagesPerLoad; i++) {
                skeletons += '<div class="masonry-item"><div class="skeleton"></div></div>';
            }
            galleryGrid.innerHTML = skeletons;
        };

        const loadImages = () => {
            const imagesToLoad = allImages.slice(displayedImages, displayedImages + imagesPerLoad);
            
            const fragment = document.createDocumentFragment();
            const newItems = []; // Keep track of the new DOM elements for Masonry

            imagesToLoad.forEach((image, index) => {
                const item = document.createElement('div');
                // The class that Masonry uses to identify grid items
                item.className = 'masonry-item';

                const img = document.createElement('img');
                img.src = image.url;
                img.alt = image.filename || `Gallery image ${displayedImages + index + 1}`;
                img.className = 'gallery-item w-full h-auto rounded-lg shadow-lg';
                img.style.opacity = 0; // Start invisible for fade-in
                img.style.transition = 'opacity 0.6s ease';
                
                const imageIndex = displayedImages + index;
                img.onclick = () => openLightbox(imageIndex);

                item.appendChild(img);
                fragment.appendChild(item);
                newItems.push(item);
            });

            // If it's the very first load, clear the skeletons
            if (displayedImages === 0) {
                galleryGrid.innerHTML = '';
            }

            galleryGrid.appendChild(fragment);

            // Tell Masonry about the new items and lay them out gracefully
            imagesLoaded(galleryGrid).on('progress', (instance, image) => {
                // As each new image loads, fade it in and tell Masonry to re-layout
                image.img.style.opacity = 1;
                if (msnry) {
                    msnry.layout();
                }
            }).on('done', () => {
                 // Final layout call to ensure everything is perfect
                 if(msnry) msnry.layout();
            });

            // If Masonry is already initialized, append the new items
            if (msnry) {
                msnry.appended(newItems);
            }

            displayedImages += imagesToLoad.length;

            // Update "Load More" button
            loadMoreBtn.disabled = false;
            loadMoreBtn.textContent = 'Load More Images';
            if (displayedImages >= allImages.length) {
                loadMoreBtn.classList.add('hidden');
            } else {
                loadMoreBtn.classList.remove('hidden');
            }
        };

        const fetchGalleryData = async () => {
            showSkeletons();
            try {
                const response = await fetch(GALLERY_URL);
                if (!response.ok) throw new Error('Network response was not ok');
                allImages = await response.json();
                
                if (allImages.length === 0) {
                   galleryGrid.innerHTML = '<p class="text-center text-gray-600 col-span-full">No images found.</p>';
                   return;
                }
                
                // Load the first batch of images
                loadImages();

                // NOW, INITIALIZE MASONRY for the first time
                // We wait for the first batch of images to be loaded before initializing
                imagesLoaded(galleryGrid, () => {
                    msnry = new Masonry(galleryGrid, {
                        itemSelector: '.masonry-item',
                        columnWidth: '.masonry-item', // Use item width as column width
                        percentPosition: true,
                        gutter: 16 // The space between items, in pixels
                    });
                });

            } catch (error) {
                console.error('Error fetching gallery data:', error);
                galleryGrid.innerHTML = '<p class="text-center text-red-500 col-span-full">Could not load gallery. Please try again later.</p>';
            }
        };
        
        // --- Lightbox Functions (No changes needed here) ---
        const lightbox = document.getElementById('lightbox');
        const lightboxImg = document.getElementById('lightbox-img');
        const lightboxClose = document.getElementById('lightbox-close');
        const lightboxPrev = document.getElementById('lightbox-prev');
        const lightboxNext = document.getElementById('lightbox-next');

        const showImageAtIndex = (index) => {
            if (!allImages[index]) return;
            currentLightboxIndex = index;
            lightboxImg.src = allImages[index].url;
            lightboxImg.alt = allImages[index].filename;
        };

        const openLightbox = (index) => {
            lightbox.classList.add('active');
            document.body.style.overflow = 'hidden';
            showImageAtIndex(index);
        };

        const closeLightbox = () => {
            lightbox.classList.remove('active');
            document.body.style.overflow = 'auto';
        };

        const navigateLightbox = (direction) => {
            let newIndex = currentLightboxIndex + direction;
            if (newIndex < 0) newIndex = allImages.length - 1;
            else if (newIndex >= allImages.length) newIndex = 0;
            showImageAtIndex(newIndex);
        };

        // --- Event Listeners ---
        loadMoreBtn.addEventListener('click', () => {
            loadMoreBtn.disabled = true;
            loadMoreBtn.textContent = 'Loading...';
            // No timeout needed, the image loading provides a natural delay
            loadImages(); 
        });

        lightboxClose.addEventListener('click', closeLightbox);
        lightboxPrev.addEventListener('click', () => navigateLightbox(-1));
        lightboxNext.addEventListener('click', () => navigateLightbox(1));
        
        document.addEventListener('keydown', (e) => {
            if (lightbox.classList.contains('active')) {
                if (e.key === 'Escape') closeLightbox();
                if (e.key === 'ArrowLeft') navigateLightbox(-1);
                if (e.key === 'ArrowRight') navigateLightbox(1);
            }
        });

        // --- Initialize ---
        fetchGalleryData();
    });
    </script>
</body>

</html>


